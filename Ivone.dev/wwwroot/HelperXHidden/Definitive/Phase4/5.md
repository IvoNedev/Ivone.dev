# Phase 4.5 â€” Anti-Patterns And Legacy Areas To Treat Carefully

## What To Learn
Legacy modules and duplicated logic are common sources of regressions. Understanding the warning areas prevents accidental breakage.

## Why It Exists
Older routes may depend on stored procedures, undocumented assumptions, or data structures that are not visible in modern code.

## Where It Lives In The Codebase
- Legacy API routes: `sonar-api/sonar-api/src/AreasLegacy/*`
- Stored procedure wrappers: `sonar-api/sonar-api/src/StoredProcedures/*`
- UI helpers that perform logic: `sonar/reports-web/src/app/helpers/*`

## Common Anti-Patterns
- Duplicating business logic in the UI.
- Modifying legacy routes without tracing their stored procedure dependencies.
- Changing feature keys without updating dependent reports.

## Questions And Answers
- **Which legacy endpoints are still used by UI?**
  - The safest way to confirm is to search for the endpoint paths in `sonar/sonar-web` and `sonar/reports-web`.

## Additional Questions You Should Be Able To Answer
- How can you reduce risk when touching legacy logic?
  - Add tests, trace the stored procedure calls, and verify UI usage before making changes.

## Completion Check
You can identify legacy areas and explain why changes there are high risk.
