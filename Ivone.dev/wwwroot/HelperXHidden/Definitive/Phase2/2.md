# Phase 2.2 — End-to-End User Journeys

## What To Learn
You must be able to trace a workflow from UI to API to database and back. This is essential for debugging and safe changes.

## Why It Exists
Most defects are integration defects: mismatched parameters, inconsistent transformations, or incorrect orchestration.

## Where It Lives In The Codebase
- Reports Web filter parsing: `sonar/reports-web/src/app/helpers/reportData/*`
- Reports Web report components: `sonar/reports-web/src/app/report/*`
- API report handlers: `sonar-api/sonar-api/src/Areas/Reports/*`
- Data access entities: `sonar-api/sonar-data/Entity/*`

## Journey 1: Report Rendering (Screen)
1. User selects filters in Reports Web.
2. Filters are parsed into parameters.
3. Reports Web calls a report endpoint.
4. API handler orchestrates data retrieval.
5. Reports Web renders charts and tables.

## Journey 2: Report Rendering (PDF)
1. User clicks PDF button.
2. Reports Web captures current HTML and applies PDF-specific modifications.
3. HTML is posted to the API’s `/reportpdf` endpoint.
4. Document generation converts HTML to PDF.
5. PDF is returned to the browser for download.

## Journey 3: Summative Assessment Entry
1. User enters summative assessment data.
2. API validates the data against allowed code sets.
3. Data is stored in summative assessment tables.
4. Reports can retrieve the data for any relevant assessment point.

## Questions And Answers
- **Which APIs serve which UI pages?**
  - Each report page in `sonar/reports-web/src/app/report` maps to one or more API report endpoints in `sonar-api/sonar-api/src/Areas/Reports`.

- **Where are the key filter parameters defined and parsed?**
  - Parsing occurs in Reports Web helper utilities under `sonar/reports-web/src/app/helpers/reportData/*`.

## Additional Questions You Should Be Able To Answer
- How do you trace a specific report ID to a UI component?
  - Search for the report name/ID in `sonar/reports-web/src/app/report` and follow the routing or report registry.

- How does PDF generation differ from screen rendering?
  - PDF generation uses static HTML and does not run interactive JS once captured; layout must be stable at capture time.

## Completion Check
You can map a report request from UI to API and explain how the PDF flow differs from screen rendering.
