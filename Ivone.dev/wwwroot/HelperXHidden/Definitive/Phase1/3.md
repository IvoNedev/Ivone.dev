# Phase 1.3 — Progress And Attainment In Practice (Orchestrators And Assessment Points)

## What To Learn
Progress is computed by comparing assessments across assessment points (academic year + term). Attainment is the point-in-time classification of a pupil’s status. The orchestration layer in the API is responsible for producing these derived outputs.

## Why It Exists
Progress and attainment are not raw data; they are derived. If you change the orchestration logic, you change report truth.

## Where It Lives In The Codebase
- Assessment point value object: `sonar-api/sonar-utilities/src/AssessmentPoint.cs`
- ARE orchestration: `sonar-api/sonar-api/src/Areas/Reports/Common/Orchestrators/AreAssessmentOrchestrator.cs`
- Summative completion: `sonar-api/sonar-api/src/Areas/Reports/Common/Orchestrators/SummativeCompletionOrchestrator.cs`
- Summative target orchestration: `sonar-api/sonar-api/src/Areas/Reports/Common/Orchestrators/SummativeTargetOrchestrator.cs`
- Test score orchestration: `sonar-api/sonar-api/src/Areas/TestScores/TestPaperAssessmentOrchestrator.cs`
- Statutory headline orchestration: `sonar-api/sonar-api/src/Areas/Statutory/StatutoryHeadlineOrchestrator.cs`

## How Progress Is Derived
1. Select an assessment point range (two or more points).
2. Retrieve assessments for each point and subject.
3. Map assessments to expectation categories (ARE or band categories).
4. Compare points to identify movement (progress) or status (attainment).

## Orchestrators And Their Responsibilities
### 1) AreAssessmentOrchestrator
- **File**: `sonar-api/sonar-api/src/Areas/Reports/Common/Orchestrators/AreAssessmentOrchestrator.cs`
- **Purpose**: Produces Age-Related Expectation (ARE) outcomes for summative assessments.
- **Key Methods**:
  - `CalculateSummativeAreAssessmentsForPupilSubjects(...)`
    - Accepts multiple `AssessmentPoint` values.
    - Retrieves assessments for pupils and subjects across points.
    - Calls `CalculateSummativeAreAssessmentsForPupilSubjectsInAssessmentPoint` per point.
  - `CalculateSummativeAreAssessmentsForPupilSubjectsInAssessmentPoint(...)`
    - Converts assessments into point-in-time ARE values.
    - Uses `SummativeEffectiveAssessmentCalculator` when effective assessments mode is enabled.
- **When to use**:
  - Any report that requires ARE classification for one or more points in time.

### 2) SummativeCompletionOrchestrator
- **File**: `sonar-api/sonar-api/src/Areas/Reports/Common/Orchestrators/SummativeCompletionOrchestrator.cs`
- **Purpose**: Retrieves summative assessments for a specific assessment point.
- **Key Method**:
  - `GetSummativeAssessmentsForAssessmentPointAsync(...)`
    - Single assessment point.
    - Filters by pupil IDs and subject IDs.
- **When to use**:
  - Completion and coverage analysis for a single point in time.

### 3) SummativeTargetOrchestrator
- **File**: `sonar-api/sonar-api/src/Areas/Reports/Common/Orchestrators/SummativeTargetOrchestrator.cs`
- **Purpose**: Retrieves the most recent summative targets for pupil+subject.
- **Key Method**:
  - `CalculateSummativeTargetsForPupilSubjects(...)`
    - Filters to allowed summative codes.
    - Chooses latest target per pupil/subject.
- **When to use**:
  - Target analysis and projection workflows.

### 4) TestPaperAssessmentOrchestrator
- **File**: `sonar-api/sonar-api/src/Areas/TestScores/TestPaperAssessmentOrchestrator.cs`
- **Purpose**: Classifies test scores into ARE categories for each assessment point.
- **Key Method**:
  - `CalculateTestScoreAreAssessmentsForPupilSubjects(...)`
    - Accepts multiple assessment points.
    - Filters assessments per point.
    - Categorizes each assessment using range logic.
- **When to use**:
  - Test score reporting where numeric results are mapped to expectations.

### 5) StatutoryHeadlineOrchestrator
- **File**: `sonar-api/sonar-api/src/Areas/Statutory/StatutoryHeadlineOrchestrator.cs`
- **Purpose**: Retrieves statutory headline outcomes for pupils, including expectation overlays.
- **Key Method**:
  - `GetStatutoryHeadlineDataForSubjectAsync(...)`
    - Uses year group and subject to determine which statutory headlines apply.
- **When to use**:
  - Reports that present statutory outcomes by subject.

## Questions And Answers
- **Which orchestrators compare points across terms?**
  - `AreAssessmentOrchestrator.CalculateSummativeAreAssessmentsForPupilSubjects(...)` processes multiple `AssessmentPoint` values and therefore compares across terms.
  - `TestPaperAssessmentOrchestrator.CalculateTestScoreAreAssessmentsForPupilSubjects(...)` processes multiple `AssessmentPoint` values and therefore compares across terms.

- **Which reports use band/ARE logic?**
  - Any report that calls `AreAssessmentOrchestrator` or `TestPaperAssessmentOrchestrator`, such as contextual summary, triangulation, or flight path reports.

## Additional Questions You Should Be Able To Answer
- What is the difference between effective assessments mode and point-in-time assessments?
  - Effective assessments mode returns a derived assessment for a given term based on last-known data; point-in-time assessments use only records at that exact term.

- Why does the ARE orchestration require academic year data?
  - The assessment band depends on the academic year’s offset, which influences expected bands and ARE ranges.

## Completion Check
You can identify each orchestrator, explain its purpose, list its key methods, and state which orchestrators compare assessment points across terms.
