var F=Object.defineProperty;var V=(e,t,o)=>t in e?F(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o;var g=(e,t,o)=>V(e,typeof t!="symbol"?t+"":t,o);import{r as c,R as W,j as h}from"./client.js";function M(e={}){const{nonce:t,onScriptLoadSuccess:o,onScriptLoadError:n}=e,[r,u]=c.useState(!1),d=c.useRef(o);d.current=o;const v=c.useRef(n);return v.current=n,c.useEffect(()=>{const i=document.createElement("script");return i.src="https://accounts.google.com/gsi/client",i.async=!0,i.defer=!0,i.nonce=t,i.onload=()=>{var l;u(!0),(l=d.current)===null||l===void 0||l.call(d)},i.onerror=()=>{var l;u(!1),(l=v.current)===null||l===void 0||l.call(v)},document.body.appendChild(i),()=>{document.body.removeChild(i)}},[t]),r}const B=c.createContext(null);function z({clientId:e,nonce:t,onScriptLoadSuccess:o,onScriptLoadError:n,children:r}){const u=M({nonce:t,onScriptLoadSuccess:o,onScriptLoadError:n}),d=c.useMemo(()=>({clientId:e,scriptLoadedSuccessfully:u}),[e,u]);return W.createElement(B.Provider,{value:d},r)}function H(){const e=c.useContext(B);if(!e)throw new Error("Google OAuth components must be used within GoogleOAuthProvider");return e}function q(e){var t;return(t=e==null?void 0:e.clientId)!==null&&t!==void 0?t:e==null?void 0:e.client_id}const K={large:40,medium:32,small:20};function Q({onSuccess:e,onError:t,useOneTap:o,promptMomentNotification:n,type:r="standard",theme:u="outline",size:d="large",text:v,shape:i,logo_alignment:l,width:L,locale:R,click_listener:k,containerProps:m,...P}){const A=c.useRef(null),{clientId:C,scriptLoadedSuccessfully:T}=H(),G=c.useRef(e);G.current=e;const y=c.useRef(t);y.current=t;const N=c.useRef(n);return N.current=n,c.useEffect(()=>{var b,p,S,_,E,O,x,j,I;if(T)return(S=(p=(b=window==null?void 0:window.google)===null||b===void 0?void 0:b.accounts)===null||p===void 0?void 0:p.id)===null||S===void 0||S.initialize({client_id:C,callback:s=>{var f;if(!(s!=null&&s.credential))return(f=y.current)===null||f===void 0?void 0:f.call(y);const{credential:w,select_by:D}=s;G.current({credential:w,clientId:q(s),select_by:D})},...P}),(O=(E=(_=window==null?void 0:window.google)===null||_===void 0?void 0:_.accounts)===null||E===void 0?void 0:E.id)===null||O===void 0||O.renderButton(A.current,{type:r,theme:u,size:d,text:v,shape:i,logo_alignment:l,width:L,locale:R,click_listener:k}),o&&((I=(j=(x=window==null?void 0:window.google)===null||x===void 0?void 0:x.accounts)===null||j===void 0?void 0:j.id)===null||I===void 0||I.prompt(N.current)),()=>{var s,f,w;o&&((w=(f=(s=window==null?void 0:window.google)===null||s===void 0?void 0:s.accounts)===null||f===void 0?void 0:f.id)===null||w===void 0||w.cancel())}},[C,T,o,r,u,d,v,i,l,L,R]),W.createElement("div",{...m,ref:A,style:{height:K[d],...m==null?void 0:m.style}})}new TextEncoder;const J=new TextDecoder;function X(e){if(Uint8Array.fromBase64)return Uint8Array.fromBase64(e);const t=atob(e),o=new Uint8Array(t.length);for(let n=0;n<t.length;n++)o[n]=t.charCodeAt(n);return o}function Y(e){if(Uint8Array.fromBase64)return Uint8Array.fromBase64(typeof e=="string"?e:J.decode(e),{alphabet:"base64url"});let t=e;t instanceof Uint8Array&&(t=J.decode(t)),t=t.replace(/-/g,"+").replace(/_/g,"/").replace(/\s/g,"");try{return X(t)}catch{throw new TypeError("The input to be decoded is not correctly encoded.")}}class U extends Error{constructor(o,n){var r;super(o,n);g(this,"code","ERR_JOSE_GENERIC");this.name=this.constructor.name,(r=Error.captureStackTrace)==null||r.call(Error,this,this.constructor)}}g(U,"code","ERR_JOSE_GENERIC");class a extends U{constructor(){super(...arguments);g(this,"code","ERR_JWT_INVALID")}}g(a,"code","ERR_JWT_INVALID");function Z(e){return typeof e=="object"&&e!==null}const $=e=>{if(!Z(e)||Object.prototype.toString.call(e)!=="[object Object]")return!1;if(Object.getPrototypeOf(e)===null)return!0;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t};function ee(e){if(typeof e!="string")throw new a("JWTs must use Compact JWS serialization, JWT must be a string");const{1:t,length:o}=e.split(".");if(o===5)throw new a("Only JWTs using Compact JWS serialization can be decoded");if(o!==3)throw new a("Invalid JWT");if(!t)throw new a("JWTs must contain a payload");let n;try{n=Y(t)}catch{throw new a("Failed to base64url decode the payload")}let r;try{r=JSON.parse(J.decode(n))}catch{throw new a("Failed to parse the decoded payload as JSON")}if(!$(r))throw new a("Invalid JWT Claims Set");return r}const ne=()=>{const e=o=>{const n=ee(o.credential);localStorage.setItem("user",JSON.stringify(n)),window.location.reload()},t=()=>{alert("Google Sign In was unsuccessful. Try again later")};return h.jsx(z,{clientId:"401410826720-1vl5fnvuts7pu5mk5l3hovrgcemdoc7l.apps.googleusercontent.com",children:h.jsx("div",{className:"flex items-center justify-center min-h-screen",children:h.jsxs("div",{className:"p-6 bg-white rounded shadow-md",children:[h.jsx("h2",{className:"text-2xl mb-4",children:"Login with Google"}),h.jsx(Q,{onSuccess:e,onError:t})]})})})};export{ne as L};
