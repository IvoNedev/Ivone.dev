@page "/bj"
@model Ivone.dev.Pages.BjModel
@{
    ViewData["Title"] = "Blackjack Trainer";
}

<div class="bj-layout">
    <section class="bj-table">
        <details id="bj-panel-counts" class="bj-collapsible" open>
            <summary>Counts & Shoe Panel</summary>
            <div class="bj-collapsible-body">
                <div class="bj-strip">
                    <div class="bj-pill"><span>Bankroll</span><strong id="bj-bankroll-now">&euro;0</strong></div>
                    <div class="bj-pill"><span>Running</span><strong id="bj-running-count">-</strong></div>
                    <div class="bj-pill"><span>True</span><strong id="bj-true-count">-</strong></div>
                    <div class="bj-pill"><span>Shoe</span><strong id="bj-shoe-depth">-</strong></div>
                </div>
                <label class="bj-inline-check">
                    <input id="bj-mask-counts" type="checkbox" />
                    Hide live running/true counts while I play
                </label>
            </div>
        </details>

        <div class="bj-game-focus">
            <h2 id="bj-lobby-label" class="bj-lobby-neutral">Lobby</h2>

            <div class="bj-dealer">
                <h3>Dealer <small id="bj-dealer-total">-</small></h3>
                <div id="bj-dealer-cards" class="bj-cards"></div>
            </div>

            <div>
                <h3>Player Hands</h3>
                <div id="bj-player-hands" class="bj-hand-stack"></div>
            </div>
        </div>

        <details id="bj-panel-controls" class="bj-collapsible" open>
            <summary>Game Controls Panel</summary>
            <div class="bj-collapsible-body">
                <div class="bj-bet-row">
                    <label class="bj-bet-compact">
                        <span id="bj-bet-label">Bet (&euro; | Bank &euro;0)</span>
                        <input id="bj-bet-units" type="number" min="1" value="1" />
                    </label>
                    <button id="bj-deal" class="bj-btn">Deal Hand</button>
                    <label class="bj-inline-check bj-nowrap">
                        <input id="bj-auto-deal" type="checkbox" checked />
                        Auto next hand
                    </label>
                </div>

                <div class="bj-action-row" id="bj-actions">
                    <button type="button" class="bj-btn bj-action-btn" data-action="Hit">Hit</button>
                    <button type="button" class="bj-btn bj-action-btn" data-action="Stand">Hold</button>
                    <button type="button" class="bj-btn bj-action-btn" data-action="Double">Double</button>
                    <button type="button" class="bj-btn bj-action-btn" data-action="Split">Split</button>
                    <button type="button" class="bj-btn bj-action-btn" data-action="InsuranceTake">Take Insurance</button>
                    <button type="button" class="bj-btn bj-action-btn" data-action="InsuranceSkip">Skip Insurance</button>
                </div>

                <details id="bj-panel-strategy" class="bj-collapsible nested" open>
                    <summary>Strategy Panel</summary>
                    <div class="bj-collapsible-body bj-hint">
                        <div class="bj-hint-grid">
                            <section class="bj-hint-card">
                                <h4>Your Action</h4>
                                <strong id="bj-hint-player-action">-</strong>
                                <span id="bj-hint-status" class="bj-hint-status bj-hint-status-neutral">Waiting</span>
                            </section>
                            <section class="bj-hint-card">
                                <h4>Optimal Action</h4>
                                <strong id="bj-hint-optimal-action">-</strong>
                                <p id="bj-hint-text">-</p>
                            </section>
                        </div>
                    </div>
                </details>
            </div>
        </details>

        <details id="bj-panel-log" class="bj-collapsible" open>
            <summary>Activity Log Panel</summary>
            <div class="bj-collapsible-body">
                <div id="bj-log-list"></div>
            </div>
        </details>

        <details id="bj-panel-stats" class="bj-collapsible" open>
            <summary>Session Stats Panel</summary>
            <div class="bj-collapsible-body bj-stats">
                <div class="bj-stats-grid">
                    <div><span>Rounds</span><strong id="bj-stat-rounds">0</strong></div>
                    <div><span>Hands</span><strong id="bj-stat-hands">0</strong></div>
                    <div><span>Basic %</span><strong id="bj-stat-basic">0</strong></div>
                    <div><span>Deviation %</span><strong id="bj-stat-deviation">0</strong></div>
                    <div><span>Bet %</span><strong id="bj-stat-bet">0</strong></div>
                    <div><span>RC %</span><strong id="bj-stat-rc">0</strong></div>
                    <div><span>TC %</span><strong id="bj-stat-tc">0</strong></div>
                    <div><span>EV Leak</span><strong id="bj-stat-ev">&euro;0</strong></div>
                </div>
                <ul id="bj-mistakes" class="bj-mistakes"></ul>
            </div>
        </details>

        <details id="bj-panel-history" class="bj-collapsible" open>
            <summary>Recent Hands / History Panel</summary>
            <div class="bj-collapsible-body bj-history">
                <div id="bj-history-list"></div>
            </div>
        </details>
    </section>

    <aside class="bj-panel">
        <details id="bj-panel-settings" class="bj-collapsible" open>
            <summary>Settings Panel (Aids + Theme)</summary>
            <div class="bj-collapsible-body">
                <h3 class="bj-subheading">Training Aids</h3>
                <div class="bj-checks">
                    <label><input id="bj-h17" type="checkbox" checked /> Dealer hits soft 17</label>
                    <label><input id="bj-das" type="checkbox" checked /> Double after split</label>
                    <label><input id="bj-rsa" type="checkbox" /> Resplit aces</label>
                    <label><input id="bj-insurance" type="checkbox" checked /> Insurance available</label>
                    <label><input id="bj-show-rc" type="checkbox" checked /> Allow running count display</label>
                    <label><input id="bj-show-tc" type="checkbox" checked /> Allow true count display</label>
                    <label><input id="bj-show-depth" type="checkbox" checked /> Allow shoe depth display</label>
                    <label><input id="bj-show-hints" type="checkbox" checked /> Allow strategy hints</label>
                </div>

                <h3 class="bj-subheading">Theme</h3>
                <div class="bj-grid">
                    <label>Color Theme
                        <select id="bj-theme">
                            <option value="dark">Dark</option>
                            <option value="light">Light</option>
                        </select>
                    </label>
                </div>

                <h3 class="bj-subheading">Count Sign Drill Targets (seconds)</h3>
                <div class="bj-grid">
                    <label>L1 acceptable (10 cards)
                        <input id="bj-count-quiz-target-l1" type="number" min="0.1" step="0.1" value="4.0" />
                    </label>
                    <label>L2 acceptable (20 cards)
                        <input id="bj-count-quiz-target-l2" type="number" min="0.1" step="0.1" value="7.0" />
                    </label>
                    <label>L3 acceptable (52 cards)
                        <input id="bj-count-quiz-target-l3" type="number" min="0.1" step="0.1" value="16.0" />
                    </label>
                    <label>L3 strong (52 cards)
                        <input id="bj-count-quiz-strong-l3" type="number" min="0.1" step="0.1" value="15.0" />
                    </label>
                    <label>L4 acceptable (52 cards)
                        <input id="bj-count-quiz-target-l4" type="number" min="0.1" step="0.1" value="13.0" />
                    </label>
                    <label>L4 strong (52 cards)
                        <input id="bj-count-quiz-strong-l4" type="number" min="0.1" step="0.1" value="12.0" />
                    </label>
                    <label>L5 acceptable (52 cards)
                        <input id="bj-count-quiz-target-l5" type="number" min="0.1" step="0.1" value="20.0" />
                    </label>
                    <label>L5 strong (52 cards)
                        <input id="bj-count-quiz-strong-l5" type="number" min="0.1" step="0.1" value="15.0" />
                    </label>
                </div>

                <h3 class="bj-subheading">Speed Count Targets (seconds)</h3>
                <div class="bj-grid">
                    <label>L1 acceptable (10 cards)
                        <input id="bj-speed-target-l1" type="number" min="0.1" step="0.1" value="4.0" />
                    </label>
                    <label>L2 acceptable (20 cards)
                        <input id="bj-speed-target-l2" type="number" min="0.1" step="0.1" value="7.0" />
                    </label>
                    <label>L3 acceptable (52 cards)
                        <input id="bj-speed-target-l3" type="number" min="0.1" step="0.1" value="30.0" />
                    </label>
                    <label>L3 strong (52 cards)
                        <input id="bj-speed-strong-l3" type="number" min="0.1" step="0.1" value="22.0" />
                    </label>
                    <label>L4 acceptable (52 cards)
                        <input id="bj-speed-target-l4" type="number" min="0.1" step="0.1" value="22.0" />
                    </label>
                    <label>L4 strong (52 cards)
                        <input id="bj-speed-strong-l4" type="number" min="0.1" step="0.1" value="20.0" />
                    </label>
                    <label>L5 acceptable (52 cards)
                        <input id="bj-speed-target-l5" type="number" min="0.1" step="0.1" value="18.0" />
                    </label>
                    <label>L5 strong (52 cards)
                        <input id="bj-speed-strong-l5" type="number" min="0.1" step="0.1" value="15.0" />
                    </label>
                </div>
                <p class="bj-mono">Readiness rule: 5 perfect runs in a row (0 mistakes, under target), repeated on 2 separate days.</p>

                <button id="bj-start-session" class="bj-btn primary">Start New Session</button>
                <p id="bj-session-label" class="bj-mono">Session: -</p>
            </div>
        </details>
    </aside>

    <details id="bj-panel-rules" class="bj-collapsible bj-rules-bottom" open>
        <summary>Rules Panel</summary>
        <div class="bj-collapsible-body">
            <div class="bj-grid">
                <label>Mode
                    <select id="bj-mode">
                        <option value="Guided">Guided</option>
                        <option value="FreePlay">Free Play</option>
                        <option value="CountingOnly">Counting Only</option>
                        <option value="DeviationsOnly">Deviations Only</option>
                        <option value="BetSizingOnly">Bet Sizing Only</option>
                        <option value="Exam">Exam</option>
                    </select>
                </label>
                <label>Decks
                    <select id="bj-decks">
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="4">4</option>
                        <option value="6" selected>6</option>
                        <option value="8">8</option>
                    </select>
                </label>
                <label>Penetration %
                    <input id="bj-penetration" type="number" min="55" max="90" value="75" />
                </label>
                <label>Burn Cards
                    <input id="bj-burn" type="number" min="0" max="16" value="1" />
                </label>
                <label>Spread Max
                    <input id="bj-spread" type="number" min="2" max="20" value="8" />
                </label>
                <label>Bankroll (&euro;)
                    <input id="bj-bankroll" type="number" min="10" value="200" />
                </label>
                <label>Max Splits
                    <input id="bj-max-splits" type="number" min="1" max="4" value="3" />
                </label>
                <label>Double Rule
                    <select id="bj-double-rule">
                        <option value="AnyTwo">Any Two</option>
                        <option value="NineToEleven">9-11</option>
                        <option value="TenToEleven">10-11</option>
                    </select>
                </label>
                <label>Blackjack Payout
                    <select id="bj-payout">
                        <option value="ThreeToTwo">3:2</option>
                        <option value="SixToFive">6:5</option>
                    </select>
                </label>
            </div>
        </div>
    </details>

    <details id="bj-panel-guide" class="bj-collapsible bj-guide-bottom" open>
        <summary>Quick Guide Panel (Expanded Basics)</summary>
        <div class="bj-collapsible-body">
            <div class="bj-guide">
                <p>Fast practical rules for live play and count training.</p>
                <h4>Basic Strategy (practical)</h4>
                <ul>
                    <li>Hard totals: stand on 17+, hit 8 or less.</li>
                    <li>Hard 13-16: stand vs dealer 2-6, hit vs 7-A.</li>
                    <li>Hard 12: stand vs 4-6, hit vs 2-3 or 7-A.</li>
                    <li>Double 11 vs most upcards; 10 vs 2-9; 9 vs 3-6.</li>
                    <li>Soft hands: A,8 usually stands; A,7 doubles vs 3-6 if allowed.</li>
                    <li>Pairs: split A,A and 8,8; never split 10,10 or 5,5.</li>
                    <li>Insurance is generally a bad base-strategy play unless the count is strong.</li>
                    <li>No surrender: 15 and 16 high-pressure spots are played as hit/stand only.</li>
                </ul>
                <h4>Hi-Lo Counting (practical)</h4>
                <ul>
                    <li>2-6 = +1, 7-9 = 0, 10-A = -1.</li>
                    <li>Running Count (RC): update on every exposed card.</li>
                    <li>True Count (TC): RC divided by decks remaining.</li>
                    <li>Higher TC supports larger bets; TC <= 0 stays near base bet.</li>
                    <li>Classic index example: 16 vs 10 tends to stand around TC 0+.</li>
                    <li>When deck count is low, each single card swings TC more than early in the shoe.</li>
                    <li>Stay consistent in rounding TC so betting and deviation decisions match your plan.</li>
                </ul>
            </div>
        </div>
    </details>

    <details id="bj-panel-basic" class="bj-collapsible bj-basic-bottom" open>
        <summary>Basic Strategy Chart Panel</summary>
        <div class="bj-collapsible-body">
            <p class="bj-chart-note">
                Baseline chart for trainer defaults: multi-deck, H17, DAS on, no surrender, double any two.
            </p>

            <div class="bj-legend">
                <span class="bj-act bj-act-hit">H</span><span>Hit</span>
                <span class="bj-act bj-act-stand">HOLD</span><span>Stand / Hold</span>
                <span class="bj-act bj-act-double">D</span><span>Double</span>
                <span class="bj-act bj-act-dh">D/H</span><span>Double else Hit</span>
                <span class="bj-act bj-act-ds">D/S</span><span>Double else Stand</span>
                <span class="bj-act bj-act-split">1/2</span><span>Split</span>
            </div>

            <div class="bj-chart-grid">
                <div class="bj-chart-wrap">
                    <h4>Hard Totals</h4>
                    <table class="bj-chart">
                        <thead>
                            <tr>
                                <th>Player</th>
                                <th>Dealer Upcard</th>
                                <th>Play</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td>8 or less</td><td>Any</td><td><span class="bj-act bj-act-hit">H</span></td></tr>
                            <tr><td>9</td><td>3-6</td><td><span class="bj-act bj-act-dh">D/H</span></td></tr>
                            <tr><td>9</td><td>2, 7-A</td><td><span class="bj-act bj-act-hit">H</span></td></tr>
                            <tr><td>10</td><td>2-9</td><td><span class="bj-act bj-act-dh">D/H</span></td></tr>
                            <tr><td>10</td><td>10, A</td><td><span class="bj-act bj-act-hit">H</span></td></tr>
                            <tr><td>11</td><td>2-A</td><td><span class="bj-act bj-act-dh">D/H</span></td></tr>
                            <tr><td>12</td><td>4-6</td><td><span class="bj-act bj-act-stand">S</span></td></tr>
                            <tr><td>12</td><td>2-3, 7-A</td><td><span class="bj-act bj-act-hit">H</span></td></tr>
                            <tr><td>13-16</td><td>2-6</td><td><span class="bj-act bj-act-stand">S</span></td></tr>
                            <tr><td>13-16</td><td>7-A</td><td><span class="bj-act bj-act-hit">H</span></td></tr>
                            <tr><td>17+</td><td>Any</td><td><span class="bj-act bj-act-stand">S</span></td></tr>
                        </tbody>
                    </table>
                </div>

                <div class="bj-chart-wrap">
                    <h4>Soft Totals</h4>
                    <table class="bj-chart">
                        <thead>
                            <tr>
                                <th>Player</th>
                                <th>Dealer Upcard</th>
                                <th>Play</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td>A,2 / A,3</td><td>5-6</td><td><span class="bj-act bj-act-dh">D/H</span></td></tr>
                            <tr><td>A,2 / A,3</td><td>2-4, 7-A</td><td><span class="bj-act bj-act-hit">H</span></td></tr>
                            <tr><td>A,4 / A,5</td><td>4-6</td><td><span class="bj-act bj-act-dh">D/H</span></td></tr>
                            <tr><td>A,4 / A,5</td><td>2-3, 7-A</td><td><span class="bj-act bj-act-hit">H</span></td></tr>
                            <tr><td>A,6</td><td>3-6</td><td><span class="bj-act bj-act-dh">D/H</span></td></tr>
                            <tr><td>A,6</td><td>2, 7-A</td><td><span class="bj-act bj-act-hit">H</span></td></tr>
                            <tr><td>A,7</td><td>3-6</td><td><span class="bj-act bj-act-ds">D/S</span></td></tr>
                            <tr><td>A,7</td><td>2, 7, 8</td><td><span class="bj-act bj-act-stand">S</span></td></tr>
                            <tr><td>A,7</td><td>9, 10, A</td><td><span class="bj-act bj-act-hit">H</span></td></tr>
                            <tr><td>A,8</td><td>6 (H17)</td><td><span class="bj-act bj-act-ds">D/S</span></td></tr>
                            <tr><td>A,8</td><td>Other upcards</td><td><span class="bj-act bj-act-stand">S</span></td></tr>
                            <tr><td>A,9</td><td>Any</td><td><span class="bj-act bj-act-stand">S</span></td></tr>
                        </tbody>
                    </table>
                </div>

                <div class="bj-chart-wrap">
                    <h4>Pairs</h4>
                    <table class="bj-chart">
                        <thead>
                            <tr>
                                <th>Pair</th>
                                <th>Dealer Upcard</th>
                                <th>Play</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td>A,A</td><td>Any</td><td><span class="bj-act bj-act-split">1/2</span></td></tr>
                            <tr><td>10,10</td><td>Any</td><td><span class="bj-act bj-act-stand">S</span></td></tr>
                            <tr><td>9,9</td><td>2-6, 8-9</td><td><span class="bj-act bj-act-split">1/2</span></td></tr>
                            <tr><td>9,9</td><td>7, 10, A</td><td><span class="bj-act bj-act-stand">S</span></td></tr>
                            <tr><td>8,8</td><td>Any</td><td><span class="bj-act bj-act-split">1/2</span></td></tr>
                            <tr><td>7,7</td><td>2-7</td><td><span class="bj-act bj-act-split">1/2</span></td></tr>
                            <tr><td>7,7</td><td>8-A</td><td><span class="bj-act bj-act-hit">H</span></td></tr>
                            <tr><td>6,6</td><td>3-6</td><td><span class="bj-act bj-act-split">1/2</span></td></tr>
                            <tr><td>6,6</td><td>2, 7-A</td><td><span class="bj-act bj-act-hit">H</span></td></tr>
                            <tr><td>5,5</td><td>2-9</td><td><span class="bj-act bj-act-dh">D/H</span></td></tr>
                            <tr><td>5,5</td><td>10, A</td><td><span class="bj-act bj-act-hit">H</span></td></tr>
                            <tr><td>4,4 (DAS)</td><td>5-6</td><td><span class="bj-act bj-act-split">1/2</span></td></tr>
                            <tr><td>4,4 (DAS)</td><td>Other upcards</td><td><span class="bj-act bj-act-hit">H</span></td></tr>
                            <tr><td>3,3 / 2,2 (DAS)</td><td>2-7</td><td><span class="bj-act bj-act-split">1/2</span></td></tr>
                            <tr><td>3,3 / 2,2 (DAS)</td><td>8-A</td><td><span class="bj-act bj-act-hit">H</span></td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <ul class="bj-chart-tips">
                <li>No surrender table: play hit/stand fallback decisions only.</li>
                <li>No DAS: 2,2 and 3,3 split range tightens to 4-7.</li>
                <li>Single deck tweak in this trainer: 9 vs 2 can double; 12 vs 2 stands.</li>
            </ul>
        </div>
    </details>

    <details id="bj-panel-perfect" class="bj-collapsible bj-perfect-bottom" open>
        <summary>Perfect Strategy Panel (Basic + Count + Bets)</summary>
        <div class="bj-collapsible-body">
            <p class="bj-chart-note">
                Use this as your execution layer: basic chart first, then TC deviations, then bet ramp.
            </p>

            <div class="bj-chart-grid">
                <div class="bj-chart-wrap">
                    <h4>Bet Sizing Ramp (Trainer Logic)</h4>
                    <table class="bj-chart">
                        <thead>
                            <tr>
                                <th>True Count (floor)</th>
                                <th>Bet Size</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td>TC &lt;= 0</td><td><span class="bj-act bj-act-stand">1x base</span></td></tr>
                            <tr><td>TC = +1</td><td><span class="bj-act bj-act-double">2x base</span></td></tr>
                            <tr><td>TC = +2</td><td><span class="bj-act bj-act-double">4x base</span></td></tr>
                            <tr><td>TC = +3</td><td><span class="bj-act bj-act-double">6x base</span></td></tr>
                            <tr><td>TC &gt;= +4</td><td><span class="bj-act bj-act-split">Max spread</span></td></tr>
                        </tbody>
                    </table>
                </div>

                <div class="bj-chart-wrap">
                    <h4>Hi-Lo Deviations In Trainer</h4>
                    <table class="bj-chart">
                        <thead>
                            <tr>
                                <th>Situation</th>
                                <th>At / Above TC</th>
                                <th>Deviation Play</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td>Insurance vs A</td><td>+3</td><td><span class="bj-act bj-act-split">Take insurance</span></td></tr>
                            <tr><td>16 vs 10</td><td>0</td><td><span class="bj-act bj-act-stand">S</span></td></tr>
                            <tr><td>15 vs 10</td><td>+4</td><td><span class="bj-act bj-act-stand">S</span></td></tr>
                            <tr><td>12 vs 3</td><td>+2</td><td><span class="bj-act bj-act-stand">S</span></td></tr>
                            <tr><td>12 vs 2</td><td>+3</td><td><span class="bj-act bj-act-stand">S</span></td></tr>
                            <tr><td>10 vs 10</td><td>+4</td><td><span class="bj-act bj-act-double">D</span></td></tr>
                            <tr><td>10 vs A</td><td>+4</td><td><span class="bj-act bj-act-double">D</span></td></tr>
                            <tr><td>9 vs 2</td><td>+1</td><td><span class="bj-act bj-act-double">D</span></td></tr>
                            <tr><td>9 vs 7</td><td>+3</td><td><span class="bj-act bj-act-double">D</span></td></tr>
                            <tr><td>11 vs A</td><td>+1</td><td><span class="bj-act bj-act-double">D</span></td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <ul class="bj-chart-tips">
                <li>Apply one order every hand: base chart -> deviation check -> execute bet sizing.</li>
                <li>Trainer uses floor-style TC thresholds for decisions and bet sizing.</li>
                <li>If counts are hidden while practicing, lock your guess before revealing RC/TC.</li>
            </ul>
        </div>
    </details>

    <details id="bj-panel-count-quiz" class="bj-collapsible bj-quiz-bottom" open>
        <summary>Count Sign Drill Panel</summary>
        <div class="bj-collapsible-body">
            <div class="bj-speed-row">
                <div class="bj-speed-controls">
                    <label class="bj-speed-control">
                        Decks
                        <select id="bj-count-quiz-decks-select" disabled>
                            <option value="1" selected>1 (fixed)</option>
                        </select>
                    </label>
                    <label class="bj-speed-control">
                        Level
                        <select id="bj-count-quiz-level">
                            <option value="1">Level 1 (1 card out of 10)</option>
                            <option value="2">Level 2 (1 card out of 20)</option>
                            <option value="3">Level 3 (1 card out of 52)</option>
                            <option value="4">Level 4 (pairs out of 52)</option>
                            <option value="5">Level 5 (5 cards out of 52)</option>
                        </select>
                    </label>
                    <span id="bj-count-quiz-timer" class="bj-speed-timer">00:00.0</span>
                </div>
                <div class="bj-count-quiz-actions">
                    <button id="bj-count-quiz-new-shoe" class="bj-btn ghost" type="button">New Shoe</button>
                    <div class="bj-count-quiz-answer-row">
                        <button id="bj-count-quiz-plus" class="bj-btn" type="button">+</button>
                        <button id="bj-count-quiz-zero" class="bj-btn" type="button">0</button>
                        <button id="bj-count-quiz-minus" class="bj-btn" type="button">-</button>
                    </div>
                </div>
            </div>
            <div class="bj-speed-current">
                <span class="bj-speed-current-label">Current Draw</span>
                <span id="bj-count-quiz-current" class="bj-speed-last-card">-</span>
            </div>
            <div class="bj-count-quiz-feedback-row">
                <span id="bj-count-quiz-feedback" class="bj-count-quiz-feedback bj-count-quiz-feedback-neutral">Choose + / 0 / -</span>
            </div>
            <div class="bj-count-quiz-stats">
                <div><span>RC</span><strong id="bj-count-quiz-rc">0</strong></div>
                <div><span>Remaining</span><strong id="bj-count-quiz-remaining">-</strong></div>
                <div><span>Correct</span><strong id="bj-count-quiz-correct">0</strong></div>
                <div><span>Wrong</span><strong id="bj-count-quiz-wrong">0</strong></div>
                <div><span>Accuracy</span><strong id="bj-count-quiz-accuracy">0%</strong></div>
                <div><span>Last Run</span><strong id="bj-count-quiz-last-run-time">-</strong></div>
                <div><span>Best</span><strong id="bj-count-quiz-best-time">-</strong></div>
                <div><span>Last10 Perfect</span><strong id="bj-count-quiz-last10-acc">-</strong></div>
                <div><span>Goal Delta</span><strong id="bj-count-quiz-goal-delta">-</strong></div>
                <div><span>Streak</span><strong id="bj-count-quiz-ready-streak">0/5</strong></div>
                <div><span>Status</span><strong id="bj-count-quiz-ready-status" class="bj-ready-status bj-ready-status-notpassed">❌ Not passed</strong></div>
            </div>
            <div id="bj-count-quiz-stream" class="bj-speed-stream"></div>
        </div>
    </details>

    <details id="bj-panel-speed-count" class="bj-collapsible bj-speed-bottom" open>
        <summary>Speed Count Shoe Panel</summary>
        <div class="bj-collapsible-body">
            <div class="bj-speed-row">
                <div class="bj-speed-controls">
                    <label class="bj-speed-control">
                        Decks
                        <select id="bj-count-decks-select" disabled>
                            <option value="1" selected>1 (fixed)</option>
                        </select>
                    </label>
                    <label class="bj-speed-control">
                        Level
                        <select id="bj-count-level">
                            <option value="1">Level 1 (1 card out of 10)</option>
                            <option value="2">Level 2 (1 card out of 20)</option>
                            <option value="3">Level 3 (1 card out of 52)</option>
                            <option value="4">Level 4 (pairs out of 52)</option>
                            <option value="5">Level 5 (5 cards out of 52)</option>
                        </select>
                    </label>
                    <span id="bj-count-timer" class="bj-speed-timer">00:00.0</span>
                </div>
                <div class="bj-speed-actions">
                    <button id="bj-count-new-shoe" class="bj-btn ghost" type="button">New Shoe</button>
                    <button id="bj-count-hit" class="bj-btn" type="button">Hit</button>
                </div>
            </div>
            <div class="bj-speed-current">
                <span class="bj-speed-current-label">Current Draw</span>
                <span id="bj-count-last-card" class="bj-speed-last-card">-</span>
            </div>
            <label class="bj-inline-check">
                <input id="bj-count-show-counts" type="checkbox" />
                Show RC and TC
            </label>
            <div class="bj-speed-stats">
                <div><span>RC</span><strong id="bj-count-rc">0</strong></div>
                <div><span>TC</span><strong id="bj-count-tc">0</strong></div>
                <div><span>Remaining</span><strong id="bj-count-remaining">-</strong></div>
                <div><span>Last Run</span><strong id="bj-count-one-deck-time">-</strong></div>
                <div><span>Best</span><strong id="bj-count-best-time">-</strong></div>
                <div><span>Last10 Perfect</span><strong id="bj-count-last10-acc">-</strong></div>
                <div><span>Shoe Delta</span><strong id="bj-count-shoe-delta">-</strong></div>
                <div><span>Goal Delta</span><strong id="bj-count-goal-delta">-</strong></div>
                <div><span>Streak</span><strong id="bj-count-ready-streak">0/5</strong></div>
                <div><span>Status</span><strong id="bj-count-ready-status" class="bj-ready-status bj-ready-status-notpassed">❌ Not passed</strong></div>
            </div>
            <div id="bj-count-stream" class="bj-speed-stream"></div>
        </div>
    </details>
</div>

<style>
    :root {
        --bj-page-bg: #eef4fa;
        --bj-bg: rgba(5, 16, 30, 0.85);
        --bj-surface: rgba(8, 24, 40, 0.8);
        --bj-surface-strong: rgba(10, 34, 53, 0.92);
        --bj-border: #285377;
        --bj-border-soft: #264f72;
        --bj-text: #d4ecff;
        --bj-text-soft: #c8e7ff;
        --bj-field-bg: #0a2036;
        --bj-field-border: #34638c;
        --bj-card-bg: #f2fbff;
        --bj-card-text: #0f2236;
        --bj-card-border: #9cc6df;
        --bj-disabled-bg: #243747;
        --bj-disabled-text: #88a7bf;
        --bj-focus-glow: rgba(87, 162, 216, 0.22);
    }

    :root[data-bj-theme="light"] {
        --bj-page-bg: #f6f9fd;
        --bj-bg: rgba(248, 251, 255, 0.95);
        --bj-surface: rgba(238, 246, 255, 0.92);
        --bj-surface-strong: rgba(226, 239, 253, 0.98);
        --bj-border: #8ab3d6;
        --bj-border-soft: #95bbdb;
        --bj-text: #14324a;
        --bj-text-soft: #234b6b;
        --bj-field-bg: #ffffff;
        --bj-field-border: #9bc0df;
        --bj-card-bg: #ffffff;
        --bj-card-text: #1f3850;
        --bj-card-border: #9bc2df;
        --bj-disabled-bg: #dbe8f4;
        --bj-disabled-text: #6c8093;
        --bj-focus-glow: rgba(58, 124, 176, 0.2);
    }

    body { margin: 0 !important; padding: 0 !important; background: var(--bj-page-bg) !important; }
    .container, .container-fluid { max-width: none !important; padding-left: 0 !important; padding-right: 0 !important; margin-left: 0 !important; margin-right: 0 !important; }
    .app-shell { padding: 0 !important; gap: 0 !important; background: var(--bj-page-bg) !important; }
    .app-main { padding: 0 !important; border-radius: 0 !important; background: var(--bj-page-bg) !important; }

    .bj-layout { display: grid; gap: 0.35rem; grid-template-columns: 1fr; font-size: 12px; padding: 0; margin: 0; }
    .bj-table, .bj-panel { background: var(--bj-bg); border: 1px solid var(--bj-border); border-radius: 0.55rem; padding: 0.28rem; margin: 0; }
    .bj-table { order: 1; }
    .bj-panel { order: 2; }
    .bj-rules-bottom { order: 3; grid-column: 1 / -1; }
    .bj-guide-bottom { order: 4; grid-column: 1 / -1; }
    .bj-basic-bottom { order: 5; grid-column: 1 / -1; }
    .bj-perfect-bottom { order: 6; grid-column: 1 / -1; }
    .bj-quiz-bottom { order: 7; grid-column: 1 / -1; }
    .bj-speed-bottom { order: 8; grid-column: 1 / -1; }
    .bj-subheading { margin: 0.1rem 0 0.24rem; font-size: 0.8rem; color: var(--bj-text-soft); }

    .bj-game-focus {
        border: 1px solid var(--bj-border);
        border-radius: 0.52rem;
        padding: 0.36rem;
        background: var(--bj-surface);
        box-shadow: 0 0 0 1px var(--bj-focus-glow);
        margin-bottom: 0.34rem;
    }
    .bj-game-focus h2 { margin: 0 0 0.28rem; font-size: 0.88rem; }
    .bj-game-focus h3,
    .bj-game-focus h3 small { color: var(--bj-text); }
    .bj-lobby-neutral { color: var(--bj-text); }
    .bj-lobby-win { color: #39c66f; }
    .bj-lobby-loss { color: #e85d5d; }

    .bj-collapsible {
        border: 1px solid var(--bj-border);
        border-radius: 0.55rem;
        background: var(--bj-surface);
        margin-bottom: 0.3rem;
        overflow: hidden;
    }
    .bj-collapsible > summary {
        list-style: none;
        cursor: pointer;
        padding: 0.3rem 0.45rem;
        font-weight: 600;
        color: var(--bj-text);
        background: var(--bj-surface-strong);
        border-bottom: 1px solid var(--bj-border-soft);
        user-select: none;
        font-size: 0.75rem;
    }
    .bj-collapsible > summary::-webkit-details-marker { display: none; }
    .bj-collapsible > summary::marker { content: ""; }
    .bj-collapsible-body { padding: 0.3rem; }
    .bj-collapsible.nested { margin-top: 0.28rem; margin-bottom: 0; }

    .bj-grid { display: grid; grid-template-columns: repeat(2, minmax(0, 1fr)); gap: 0.35rem; }
    .bj-grid label, .bj-inline-grid label { font-size: 0.7rem; display: flex; flex-direction: column; gap: 0.15rem; color: var(--bj-text-soft); }
    .bj-checks { margin: 0.2rem 0 0.4rem; display: grid; gap: 0.18rem; font-size: 0.7rem; color: var(--bj-text-soft); }
    .bj-bet-row { margin-top: 0.2rem; display: flex; gap: 0.3rem; flex-wrap: wrap; align-items: center; }
    .bj-inline-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 0.3rem; margin-bottom: 0.24rem; }
    .bj-inline-check { display: inline-flex; align-items: center; gap: 0.24rem; font-size: 0.7rem; color: var(--bj-text-soft); }
    .bj-nowrap { white-space: nowrap; }
    .bj-inline-check.bj-nowrap { flex: 0 0 auto; }

    .bj-bet-compact { width: 96px; }
    .bj-bet-compact span { display: block; font-size: 0.68rem; margin-bottom: 0.08rem; color: var(--bj-text-soft); }

    .bj-btn { border: 1px solid #3f78a5; border-radius: 999px; padding: 0.22rem 0.5rem; font-size: 0.68rem; background: #0d2a43; color: #eaf5ff; cursor: pointer; }
    .bj-btn.primary { background: linear-gradient(135deg, #4fb2ff, #7be0ad); color: #04121f; border: none; font-weight: 600; }
    .bj-btn.ghost { background: transparent; }
    :root[data-bj-theme="light"] .bj-btn { background: #f3f9ff; color: #1e4567; border-color: #7ca9cc; }
    :root[data-bj-theme="light"] .bj-btn.primary { background: linear-gradient(135deg, #83c2f6, #8fd8b2); color: #123248; }
    .bj-btn:disabled, .bj-btn.disabled { background: var(--bj-disabled-bg); color: var(--bj-disabled-text); border-color: var(--bj-border-soft); cursor: not-allowed; opacity: 1; }
    :root[data-bj-theme="light"] .bj-btn:disabled,
    :root[data-bj-theme="light"] .bj-btn.disabled {
        background: #e4e7eb;
        color: #8e9398;
        border-color: #c5cbd2;
    }

    .bj-action-row {
        margin-top: 0.26rem;
        display: grid;
        grid-template-columns: repeat(2, minmax(6.9rem, 7.6rem));
        justify-content: end;
        gap: 0.22rem;
    }
    .bj-action-btn { width: 100%; }

    .bj-mono { font-family: ui-monospace, "Cascadia Code", "SFMono-Regular", Menlo, Consolas, monospace; font-size: 0.67rem; color: var(--bj-text-soft); }
    input, select { width: 100%; border-radius: 0.42rem; border: 1px solid var(--bj-field-border); background: var(--bj-field-bg); color: var(--bj-text); padding: 0.18rem 0.3rem; font-size: 0.68rem; }

    .bj-strip { display: grid; gap: 0.28rem; grid-template-columns: repeat(2, minmax(0, 1fr)); }
    .bj-pill { background: var(--bj-surface-strong); border: 1px solid var(--bj-border); border-radius: 0.45rem; padding: 0.27rem 0.32rem; display: flex; flex-direction: column; }
    .bj-pill span { font-size: 0.63rem; color: var(--bj-text-soft); text-transform: uppercase; letter-spacing: 0.05em; }
    .bj-pill strong { font-size: 0.76rem; margin-top: 0.06rem; color: var(--bj-text); }

    .bj-cards { display: flex; gap: 0.22rem; flex-wrap: wrap; min-height: 1.58rem; }
    .bj-card { min-width: 1.5rem; padding: 0.16rem 0.27rem; border-radius: 0.36rem; background: var(--bj-card-bg); color: var(--bj-card-text); font-weight: 700; text-align: center; border: 1px solid var(--bj-card-border); font-size: 0.67rem; }
    .bj-card.hidden { background: repeating-linear-gradient(45deg, #234867, #234867 8px, #2b5a80 8px, #2b5a80 16px); color: #d6ecfc; border-color: #5b8db5; }
    .bj-suit-red { color: #d83a46; }

    .bj-hand-stack { display: grid; gap: 0.28rem; }
    .bj-hand { border: 1px solid var(--bj-border); border-radius: 0.45rem; padding: 0.27rem; background: var(--bj-surface); }
    .bj-hand.active { border-color: #7be0ad; box-shadow: 0 0 0 1px rgba(123, 224, 173, 0.25); }
    .bj-hand-meta { font-size: 0.66rem; color: var(--bj-text-soft); margin-bottom: 0.15rem; display: flex; gap: 0.3rem; flex-wrap: wrap; }

    .bj-speed-row { display: flex; gap: 0.25rem; align-items: center; flex-wrap: wrap; margin-bottom: 0.18rem; }
    .bj-speed-controls { display: flex; align-items: center; gap: 0.25rem; flex-wrap: wrap; flex: 1 1 auto; }
    .bj-speed-actions { width: 100%; display: flex; gap: 0.25rem; justify-content: flex-end; }
    .bj-speed-control { display: inline-flex; align-items: center; gap: 0.2rem; font-size: 0.66rem; color: var(--bj-text-soft); }
    .bj-speed-control select { width: auto; min-width: 6.4rem; padding: 0.16rem 0.24rem; font-size: 0.65rem; }
    .bj-speed-timer { min-width: 5.6rem; text-align: center; border: 1px solid var(--bj-border-soft); border-radius: 999px; padding: 0.12rem 0.38rem; background: var(--bj-surface-strong); color: var(--bj-text); font-size: 0.74rem; font-family: ui-monospace, "Cascadia Code", monospace; font-weight: 700; }
    .bj-speed-current { margin-bottom: 0.22rem; display: grid; gap: 0.08rem; }
    .bj-speed-current-label { font-size: 0.58rem; color: var(--bj-text-soft); text-transform: uppercase; letter-spacing: 0.05em; }
    .bj-speed-last-card { min-height: 2.65rem; min-width: 4.2rem; width: fit-content; max-width: 16rem; justify-self: start; display: flex; align-items: center; justify-content: center; text-align: center; border: 1px solid var(--bj-card-border); border-radius: 0.35rem; padding: 0.24rem 0.38rem; background: var(--bj-card-bg); color: var(--bj-card-text); font-weight: 800; font-size: 1.14rem; line-height: 1.2; }
    .bj-speed-stats { display: grid; grid-template-columns: repeat(2, minmax(0, 1fr)); gap: 0.2rem; margin-bottom: 0.2rem; }
    .bj-speed-stats div { background: var(--bj-surface-strong); border: 1px solid var(--bj-border-soft); border-radius: 0.35rem; padding: 0.16rem 0.2rem; }
    .bj-speed-stats span { display: block; font-size: 0.58rem; color: var(--bj-text-soft); text-transform: uppercase; letter-spacing: 0.05em; }
    .bj-speed-stats strong { font-size: 0.66rem; color: var(--bj-text); }
    .bj-speed-delta-better { color: #35bd6b !important; }
    .bj-speed-delta-worse { color: #dd6374 !important; }
    .bj-ready-status { display: inline-flex; align-items: center; justify-content: center; border-radius: 999px; border: 1px solid transparent; padding: 0.04rem 0.3rem; font-size: 0.58rem; line-height: 1.2; font-weight: 700; white-space: nowrap; }
    .bj-ready-status-notpassed { background: #5a4a1d; border-color: #d5a94f; color: #fff2d6; }
    .bj-ready-status-silver { background: #1f465a; border-color: #5ab5df; color: #e3f6ff; }
    .bj-ready-status-gold { background: #1d5c3a; border-color: #38c270; color: #dbffe9; }
    .bj-speed-stream { min-height: 1.1rem; display: flex; flex-wrap: wrap; gap: 0.16rem; }
    .bj-speed-chip { border: 1px solid var(--bj-card-border); border-radius: 0.3rem; padding: 0.04rem 0.18rem; background: var(--bj-card-bg); color: var(--bj-card-text); font-size: 0.61rem; font-weight: 700; }
    .bj-count-quiz-actions { width: 100%; display: grid; justify-items: end; gap: 0.24rem; }
    .bj-count-quiz-actions > #bj-count-quiz-new-shoe { min-height: 2rem; padding: 0.24rem 0.72rem; font-size: 0.78rem; }
    .bj-count-quiz-answer-row { display: flex; gap: 0.3rem; justify-content: flex-end; }
    .bj-count-quiz-answer-row .bj-btn { width: 4.25rem; min-height: 2.8rem; padding: 0.28rem 0.58rem; font-size: 1.3rem; font-weight: 800; }
    .bj-speed-actions .bj-btn { min-width: 4.25rem; min-height: 2.8rem; padding: 0.28rem 0.58rem; font-size: 1.3rem; font-weight: 800; }
    .bj-count-quiz-feedback-row { margin-bottom: 0.2rem; }
    .bj-count-quiz-feedback { display: inline-flex; align-items: center; border-radius: 999px; border: 1px solid transparent; padding: 0.08rem 0.36rem; font-size: 0.63rem; font-weight: 700; }
    .bj-count-quiz-feedback-neutral { background: #334b61; border-color: #5f7d98; color: #d6e9fa; }
    .bj-count-quiz-feedback-correct { background: #1d5c3a; border-color: #38c270; color: #dbffe9; }
    .bj-count-quiz-feedback-wrong { background: #642833; border-color: #df687a; color: #ffe3e8; }
    .bj-count-quiz-stats { display: grid; grid-template-columns: repeat(2, minmax(0, 1fr)); gap: 0.2rem; margin-bottom: 0.2rem; }
    .bj-count-quiz-stats div { background: var(--bj-surface-strong); border: 1px solid var(--bj-border-soft); border-radius: 0.35rem; padding: 0.16rem 0.2rem; }
    .bj-count-quiz-stats span { display: block; font-size: 0.58rem; color: var(--bj-text-soft); text-transform: uppercase; letter-spacing: 0.05em; }
    .bj-count-quiz-stats strong { font-size: 0.66rem; color: var(--bj-text); }
    .bj-count-quiz-chip-correct { border-color: #38c270; }
    .bj-count-quiz-chip-wrong { border-color: #df687a; }

    #bj-log-list { display: grid; gap: 0.2rem; }
    .bj-log-item { background: var(--bj-surface-strong); border: 1px solid var(--bj-border-soft); border-radius: 0.35rem; padding: 0.18rem 0.26rem; font-size: 0.66rem; color: var(--bj-text); }
    .bj-log-time { color: var(--bj-text-soft); margin-right: 0.3rem; font-family: ui-monospace, "Cascadia Code", monospace; font-size: 0.66rem; }

    .bj-hint-grid { display: grid; gap: 0.28rem; grid-template-columns: repeat(2, minmax(0, 1fr)); }
    .bj-hint-card { border: 1px solid var(--bj-border-soft); border-radius: 0.36rem; padding: 0.24rem; background: var(--bj-surface-strong); min-height: 3.6rem; display: grid; align-content: start; gap: 0.16rem; }
    .bj-hint-card h4 { margin: 0; font-size: 0.63rem; text-transform: uppercase; letter-spacing: 0.03em; color: var(--bj-text-soft); }
    .bj-hint-card strong { font-size: 0.8rem; color: var(--bj-text); }
    .bj-hint-card p { margin: 0; color: var(--bj-text); font-size: 0.67rem; }
    .bj-hint-status { display: inline-flex; align-items: center; justify-content: center; max-width: 6.8rem; border-radius: 999px; padding: 0.05rem 0.32rem; border: 1px solid transparent; font-size: 0.59rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.03em; }
    .bj-hint-status-neutral { background: #334b61; border-color: #5f7d98; color: #d6e9fa; }
    .bj-hint-status-correct { background: #1d5c3a; border-color: #38c270; color: #dbffe9; }
    .bj-hint-status-wrong { background: #642833; border-color: #df687a; color: #ffe3e8; }
    .bj-guide p { margin: 0 0 0.25rem; color: var(--bj-text); font-size: 0.68rem; }
    .bj-guide h4 { margin: 0.24rem 0 0.15rem; font-size: 0.69rem; color: var(--bj-text-soft); }
    .bj-guide ul { margin: 0; padding-left: 0.92rem; color: var(--bj-text); font-size: 0.66rem; display: grid; gap: 0.11rem; }
    .bj-chart-note { margin: 0 0 0.3rem; color: var(--bj-text-soft); font-size: 0.66rem; }
    .bj-legend { display: grid; grid-template-columns: auto 1fr; gap: 0.18rem 0.32rem; margin-bottom: 0.34rem; align-items: center; font-size: 0.64rem; color: var(--bj-text-soft); }
    .bj-chart-grid { display: grid; gap: 0.3rem; grid-template-columns: 1fr; }
    .bj-chart-wrap h4 { margin: 0 0 0.16rem; font-size: 0.68rem; color: var(--bj-text-soft); }
    .bj-chart-wrap { border: 1px solid var(--bj-border-soft); border-radius: 0.36rem; padding: 0.22rem; background: var(--bj-surface-strong); overflow-x: auto; }
    .bj-chart { width: 100%; border-collapse: collapse; font-size: 0.62rem; min-width: 290px; }
    .bj-chart th, .bj-chart td { border: 1px solid var(--bj-border-soft); padding: 0.14rem 0.2rem; text-align: left; color: var(--bj-text); }
    .bj-chart th { font-size: 0.6rem; text-transform: uppercase; letter-spacing: 0.03em; color: var(--bj-text-soft); background: rgba(0, 0, 0, 0.08); }
    .bj-chart-tips { margin: 0.32rem 0 0; padding-left: 0.95rem; color: var(--bj-text); font-size: 0.64rem; display: grid; gap: 0.1rem; }

    .bj-act { display: inline-flex; align-items: center; justify-content: center; min-width: 2.05rem; padding: 0.02rem 0.28rem; border-radius: 999px; border: 1px solid transparent; font-size: 0.58rem; line-height: 1.35; font-weight: 700; text-transform: uppercase; letter-spacing: 0.02em; }
    .bj-act-hit { background: #184c2f; border-color: #32b16a; color: #d6ffe8; }
    .bj-act-stand { background: #5b2429; border-color: #cf4f59; color: #ffd8dc; }
    .bj-act-double { background: #163f6f; border-color: #4aa5f1; color: #d5ecff; }
    .bj-act-dh { background: #654e1c; border-color: #e6b354; color: #fff3d2; }
    .bj-act-ds { background: #21534f; border-color: #4cc7bb; color: #d9fff9; }
    .bj-act-split { background: #5b3e1f; border-color: #e6a25a; color: #ffe8d1; }
    .bj-act-rh { background: #5a273a; border-color: #db5f88; color: #ffddea; }

    :root[data-bj-theme="light"] .bj-chart th { background: rgba(26, 63, 96, 0.08); }
    :root[data-bj-theme="light"] .bj-act-hit { background: #dbf7e7; border-color: #46b377; color: #155332; }
    :root[data-bj-theme="light"] .bj-act-stand { background: #ffe2e5; border-color: #df6f79; color: #7f1e27; }
    :root[data-bj-theme="light"] .bj-act-double { background: #deefff; border-color: #4d97db; color: #174b7f; }
    :root[data-bj-theme="light"] .bj-act-dh { background: #fff1d9; border-color: #d9a451; color: #6e4b12; }
    :root[data-bj-theme="light"] .bj-act-ds { background: #dcf5f1; border-color: #49ada3; color: #1f5b56; }
    :root[data-bj-theme="light"] .bj-act-split { background: #feead5; border-color: #cf8c44; color: #6b3f0f; }
    :root[data-bj-theme="light"] .bj-act-rh { background: #ffe2ec; border-color: #ca5c80; color: #6f1f3b; }
    :root[data-bj-theme="light"] .bj-suit-red { color: #bf1f2f; }
    :root[data-bj-theme="light"] .bj-hint-status-neutral { background: #dde8f2; border-color: #9bb4c8; color: #33536e; }
    :root[data-bj-theme="light"] .bj-hint-status-correct { background: #d8f2e2; border-color: #55b982; color: #1f603f; }
    :root[data-bj-theme="light"] .bj-hint-status-wrong { background: #ffe0e6; border-color: #d96a7e; color: #7a2535; }
    :root[data-bj-theme="light"] .bj-count-quiz-feedback-neutral { background: #dde8f2; border-color: #9bb4c8; color: #33536e; }
    :root[data-bj-theme="light"] .bj-count-quiz-feedback-correct { background: #d8f2e2; border-color: #55b982; color: #1f603f; }
    :root[data-bj-theme="light"] .bj-count-quiz-feedback-wrong { background: #ffe0e6; border-color: #d96a7e; color: #7a2535; }
    :root[data-bj-theme="light"] .bj-ready-status-notpassed { background: #fff1d8; border-color: #d7ac58; color: #6d4a13; }
    :root[data-bj-theme="light"] .bj-ready-status-silver { background: #dff2ff; border-color: #76b7de; color: #1d4f6b; }
    :root[data-bj-theme="light"] .bj-ready-status-gold { background: #d8f2e2; border-color: #55b982; color: #1f603f; }

    .bj-stats-grid { display: grid; gap: 0.22rem; grid-template-columns: repeat(2, minmax(0, 1fr)); }
    .bj-stats-grid div { background: var(--bj-surface-strong); border: 1px solid var(--bj-border-soft); border-radius: 0.35rem; padding: 0.18rem 0.24rem; }
    .bj-stats-grid span { font-size: 0.61rem; color: var(--bj-text-soft); text-transform: uppercase; letter-spacing: 0.05em; display: block; }
    .bj-stats-grid strong { color: var(--bj-text); font-size: 0.68rem; }

    .bj-mistakes, #bj-history-list { margin: 0.2rem 0 0; padding: 0; list-style: none; }
    #bj-history-list { display: grid; gap: 0.2rem; }
    .bj-history-item { border: 1px solid var(--bj-border-soft); border-radius: 0.35rem; padding: 0.18rem 0.26rem; background: var(--bj-surface-strong); font-size: 0.66rem; color: var(--bj-text); }

    @@media (min-width: 1080px) {
        .bj-layout { grid-template-columns: minmax(0, 1fr) minmax(300px, 330px); align-items: start; }
        .bj-strip { grid-template-columns: repeat(4, minmax(0, 1fr)); }
        .bj-stats-grid { grid-template-columns: repeat(4, minmax(0, 1fr)); }
        .bj-chart-grid { grid-template-columns: repeat(2, minmax(0, 1fr)); }
        .bj-action-row { grid-template-columns: repeat(4, minmax(0, 1fr)); justify-content: stretch; }
        .bj-count-quiz-actions { width: auto; margin-left: auto; }
        .bj-count-quiz-stats { grid-template-columns: repeat(11, minmax(0, 1fr)); }
        .bj-speed-actions { width: auto; margin-left: auto; }
        .bj-speed-stats { grid-template-columns: repeat(10, minmax(0, 1fr)); }
    }
</style>

@section Scripts {
    <script src="~/js/bj-trainer.js" asp-append-version="true" defer></script>
}
